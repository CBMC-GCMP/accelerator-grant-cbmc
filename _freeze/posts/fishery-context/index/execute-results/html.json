{
  "hash": "657ba80ef406b1d4370a3fa8ff6922c7",
  "result": {
    "markdown": "---\ntitle: \"Industrial fishery in the Mexican Pacific under Climate Change\"\nauthor: \"Fabio Favoretto, Ricardo Cavieses Nu√±ez\"\ndate: \"2022-10-14\"\ncategories: [fishery]\nimage: \"thumbnail.png\"\ncode-fold: true\neditor_options: \n  chunk_output_type: console\nbibliography: references.bib\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading libraries -------------------------------------------------------\n\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(mgcv)\nlibrary(gratia)\nlibrary(doParallel) \n\nvms <- read_rds(\"../../data/vms_spatial.RDS\")\nlandings <- read_rds(\"../../data/landings.RDS\")\n```\n:::\n\n\nNow that we know what happened to the Mexican Pacific regarding [climate change](https://cbmc-gcmp.github.io/accelerator-grant-cbmc/posts/climate-change-context/), we show the dynamics we know of the Mexican fishing industry, specifically the pelagic fleet, which is the target of our project. The Mexican pelagic fleet targets tuna, sharks, swordfish, and other pelagic animals using purse seiners and long lines. The fleet comprises around 100 powerful high-seas vessels that can store from 500 to 1,200 tons of catch in one trip.\n\n![An example of the fishing vessel deployed in the Pacific by the Pesca Azteca company.](images/paste-A20A9200.png){#fig-azteca}\n\nA first exploration to understand their traits is to see if their landings changed over time ( @fig-catches ). In fishery science usually catches are expressed in terms of Catches per Unit of Effort (CPUE) which standardize the catches for the amount of time needed to collect it. We can see a trend of CPUE in @fig-catches .\n\n\n::: {#fig-catches .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nave <- landings |>\n   filter(revi == \"Yes\") |> \n   group_by(year) |> \n   summarise(fishing_effort = mean(effort/1000)) |> \n   as.data.frame() |> \n   ungroup() |> \n   ggplot(aes(x = year, y = fishing_effort)) + \n      geom_line(col = \"red\") +\n      geom_smooth(col = \"black\") +\n      labs(x = \"\", y = \"CPUE\", title = \"Average CPUE\") +\n      theme_minimal() +\n      theme(panel.background = element_rect(fill = NA, color = NA),\n            axis.text.x = element_text(angle = 90),\n            panel.grid.minor = element_blank(),\n            panel.grid.major.x = element_blank(),\n            text = element_text(colour = \"white\"),\n            axis.text = element_text(colour = \"white\")\n      )\n\ntot <- landings |>\n   filter(revi == \"Yes\") |> \n   group_by(year) |> \n   summarise(fishing_effort = sum(effort/1000)) |> \n   as.data.frame() |> \n   ungroup() |> \n   ggplot(aes(x = year, y = fishing_effort)) + \n      geom_line(col = \"red\") +\n      geom_smooth(col = \"black\") +\n      labs(x = \"\", y = \"CPUE\", title = \"Total CPUE\") +\n      theme_minimal() +\n      theme(panel.background = element_rect(fill = NA, color = NA),\n            axis.text.x = element_text(angle = 90),\n            panel.grid.minor = element_blank(),\n            panel.grid.major.x = element_blank(),\n            text = element_text(colour = \"white\"),\n            axis.text = element_text(colour = \"white\")\n      )\n\nave\ntot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-catches-1.png){#fig-catches-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-catches-2.png){#fig-catches-2 width=672}\n:::\n\nTrend in fish catches over time in the Mexican Pacific\n:::\n\n\nIt is reasonable to expect a decrease in catches, especially after seeing the effect temperature had over the Pacific. Average CPUE shows a significant (*p* \\< 0.01) decrease of 22% \\[95%CI: -50%, -6%\\] during the warming period ( @fig-catches-1 ), whereas if we look at total CPUE, an overall **decreasing trend of 80.7 total CPUE** (in metric tons) lost each year ( @fig-catches-2 ). It seems that warming events are negatively influencing the catches. Particularly, summer months are the ones with larger impacts, with overall decreases in CPUE from May to October (@fig-bymonths-2).\n\n\n::: {#fig-bymonths .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\ntomodel <- landings |>\n      filter(revi == \"Yes\") |> \n      group_by(year, month) |> \n      summarise(fishing_effort = round(sum(effort/1000))) |> \n      as.data.frame() |> \n      ungroup() |> \n      rename(nMonth = month)\n\n\n\nknots <- list(nMonth = c(0.5, seq(1, 12, length = 10), 12.5))\n\n\nm_23 <- gamm(verbose = F,\n      fishing_effort ~ te(year, nMonth, bs = c(\"cr\", \"cc\"), k = c(5, 12)),\n      family = \"poisson\",\n      data = tomodel,\n      method = \"REML\",\n      correlation = corARMA(form = ~ 1 | year, p = 1),\n      knots = knots\n)\n\npdat <- with(tomodel,\n             data.frame(\n                   year = rep(seq(2008,2022), each = 100),\n                   nMonth = rep(seq(1, 12, length = 100), times = 15)\n             ))\n\npred <- predict(m_23$gam, newdata = pdat, se.fit = TRUE)\ncrit <- qt(0.975, df = df.residual(m_23$gam)) \npdat <- transform(\n      pdat,\n      fitted = pred$fit,\n      se = pred$se.fit,\n      fYear = as.factor(year)\n)\npdat <- transform(pdat,\n                  upper = fitted + (crit * se),\n                  lower = fitted - (crit * se))\n\np1 <- ggplot(pdat, aes(x = nMonth, y = fitted, group = fYear)) +\n      geom_line(aes(colour = fYear), size = 1.2) +   \n      labs(y = \"CPUE\",\n           x = \"Month\", \n            col = \"\") +\n      scale_color_viridis_d() +\n      scale_x_continuous(breaks = 1:12,\n                         labels = month.abb,\n                          minor_breaks = NULL) +\n      theme_minimal() +\n      theme(\n            panel.background = element_rect(fill = NA, color = NA),\n            axis.text = element_text(colour = \"white\"),\n            panel.grid = element_line(colour = \"gray50\"),      \n            legend.position = \"bottom\",\n            text = element_text(colour = \"white\"),\n            legend.margin = margin()\n      )\n\npred <- predict(m_23$gam, newdata = pdat, se.fit = TRUE)\ncrit <- qt(0.975, df = df.residual(m_23$gam)) \npdat <- transform(\n      pdat,\n      fitted = pred$fit,\n      se = pred$se.fit,\n      fYear = as.factor(year)\n)\npdat <- transform(pdat,\n                  upper = fitted + (crit * se),\n                  lower = fitted - (crit * se))\n\np2 <- pdat %>%\n      pivot_wider(nMonth, names_from = year, values_from = fitted) %>%\n      mutate(diff = `2021` - `2008`) %>%\n      ggplot(aes(x = nMonth, y = diff)) +\n      geom_line(aes(col = \"Difference in CPUE\"), size = 1.2) +\n      scale_color_manual(values = \"red\") +\n      scale_x_continuous(breaks = 1:12,\n                         labels = month.abb,\n                         minor_breaks = NULL) +\n      labs(\n            y = \"CPUE\",\n            x = \"Month\", \n            col = \"\"\n      ) +\n      geom_hline(yintercept = 0, size = 1, col = \"white\") +\n      theme_minimal() +\n      theme(\n            panel.background = element_rect(fill = NA, color = NA),\n            axis.text = element_text(colour = \"white\"),\n            panel.grid = element_line(colour = \"gray50\"),      \n            legend.position = \"bottom\",\n            text = element_text(colour = \"white\"),\n            legend.margin = margin()\n      )\n\np1\np2 \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-bymonths-1.png){#fig-bymonths-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-bymonths-2.png){#fig-bymonths-2 width=672}\n:::\n\nChange of CPUE in each month from 2008 to 2022. a) compares the seasonal trend of CPUE over time; b) shows the difference between 2008 and 2022, highlighting how CPUE have changed in magnitude\n:::\n\n\n## Space-time model of fishing yields\n\nThe industrial fishing fleet is highly adaptable. When fishing is discussed, one often pictures an artisanal fisherman roaming coastal waters. However, the reality is that fisheries are highly industrialized, and Mexico is no exception. Some of these vessels' capacity is large regarding autonomy at sea and catch yield ( @fig-azteca ).\n\nSuch a capacity allows them to counteract climate change events by changing fishing grounds, or increasing fishing efforts. The most important fishing grounds are located northward, and fishing activity has increased at higher latitudes (32 degrees). Such a shift is related to species redistribution as noted by previous studies @cheung2010 .\n\nVessels also used a specific part of the Mexican Pacific from -100 to -120 degrees of latitude. The area corresponds to the influence of the Southern California Current. It underlines the importance of the functioning of this current for marine productivity and the fishery it sustains.\n\n\n::: {#fig-lonlatchange .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nmod_data_lat <- vms |>\n      group_by(date, latitude) |>\n      summarise(relative = mean(relative)) |>\n      mutate(Year = year(date), nMonth = month(date)) \n\nfullM_sst <- bam(\n      relative ~\n            t2(\n                  Year,\n                  latitude,\n                  bs = c(\"tp\", \"tp\"),\n                  k = c(10, 10),\n                  m = 2\n            ),\n      correlation = corARMA(form = ~ 1 | Year, p = 1),\n      data = mod_data_lat,\n      method = \"REML\"\n)\n\nnew_data <-\n      data.frame(latitude = rep(seq(\n            from = -10, to = 31, by = 0.1\n      ), each = 13),\n      Year = rep(seq(\n            from = 2009, to = 2021, by = 1\n      ), 411))\n\npred_paci <- predict(fullM_sst, new_data)\n\nlat_plot <- new_data |>\n         ggplot(aes(\n               x = Year,\n               y = latitude,\n               z = pred_paci,\n               fill = pred_paci\n         )) +\n      geom_raster(interpolate = TRUE) +\n      geom_contour(col = \"black\") +\n      labs(fill = \"Relative CPUE\", y = \"Latitude\") +\n      scale_x_continuous(breaks = seq(2008, 2022, by = 2)) +\n      scale_y_continuous(breaks = seq(-10, 32, by = 2)) +\n      scale_fill_distiller(\n            palette = \"RdBu\",\n            direction = -1,\n            type = \"div\"\n      ) +\n      theme_minimal() +\n      theme(\n            panel.grid = element_blank(),\n            legend.position = \"bottom\",\n            plot.title = element_text(face = \"italic\"),\n            axis.text.x = element_text(angle = 45, hjust = 1),\n            legend.title = element_text(vjust = .8),\n            text = element_text(colour = \"white\"),\n            axis.text = element_text(colour = \"white\"),\n            panel.background = element_rect(fill = NA, color = NA)\n      )\n\nmod_data_lat_long <- vms |>\n      mutate(Year = year(date), nMonth = month(date)) |> \n      group_by(Year, nMonth, longitude) |> \n      summarise(relative = mean(relative))\n       \n\nfullM_sst <- bam(\n      relative ~\n            t2(\n                  Year,\n                  longitude,\n                  bs = c(\"tp\", \"tp\"),\n                  k = c(10, 10),\n                  m = 2\n            ),\n      correlation = corARMA(form = ~ 1 | Year, p = 1),\n      data = mod_data_lat_long,\n      method = \"REML\"\n)\n\nnew_data_long <-\n      data.frame(longitude = rep(seq(\n            from = -140.0, to = -87.0, by = 0.1\n      ), each = 13),\n      Year = rep(seq(\n            from = 2009, to = 2021, by = 1\n      ), 531))\n\npred_paci_long <- predict(fullM_sst, new_data_long)\n\nlong_plot <- new_data_long |>\n      ggplot(aes(\n            x = Year,\n            y = longitude,\n            z = pred_paci_long,\n            fill = pred_paci_long\n      )) +\n      geom_raster(interpolate = TRUE) +\n      geom_contour(col = \"black\") +\n      labs(fill = \"Relative CPUE\", y = \"Longitude\") +\n      scale_x_continuous(breaks = seq(2008, 2022, by = 2)) +\n      scale_y_continuous(breaks = seq(-140, -87, by = 2)) +\n      scale_fill_distiller(\n            palette = \"RdBu\",\n            direction = -1,\n            type = \"div\"\n      ) +\n      theme_minimal() +\n      theme(\n            panel.grid = element_blank(),\n            legend.position = \"bottom\",\n            plot.title = element_text(face = \"italic\"),\n            axis.text.x = element_text(angle = 45, hjust = 1),\n            legend.title = element_text(vjust = .8),\n            text = element_text(colour = \"white\"),\n            axis.text = element_text(colour = \"white\"),\n            panel.background = element_rect(fill = NA, color = NA)\n      )\nlat_plot\nlong_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-lonlatchange-1.png){#fig-lonlatchange-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-lonlatchange-2.png){#fig-lonlatchange-2 width=672}\n:::\n\nSpatiotemporal variation in relative catch per unit of effort (CPUE) in the Mexican Pacific by a) Latitude, and b) longitude\n:::\n\n\nIndustrial vessels also are stretching further at sea, pushed by the overexploitation of coastal areas and the improvement of marine technologies. Exploiting the high seas ( @fig-spattrend ) represents an ecological threat, and fishery management becomes more complex to implement.\n\nThis spatial displacement allows industrial fisheries to maintain their catches in an overexploited Mexican Pacific. Therefore, if we look at just the catches, we would not be able to understand the complete picture that the spatial displacement is showing. This underlines the importance of the accelerator grant that aided us in deploying sufficient computational power to analyze the entire Vessel Monitoring System database (see [VMS section](https://cbmc-gcmp.github.io/accelerator-grant-cbmc/posts/an-intro-to-vms-data/) for further description of the dataset).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvms_Trend <- readRDS(file = \"../../data/vms_Trend.RDS\")\n\nmap_base <-\n      ggplot2::fortify(maps::map(fill = TRUE, plot = FALSE)) %>%\n      dplyr::rename(lon = long)\n\nvms_tomap <- vms_Trend |>\n      mutate(lat = round(lat), lon = round(lon)) |>\n      group_by(lon, lat) |>\n      summarise(slope = mean(slope)) |>\n      mutate(slope = round(slope, 2)) |>\n      filter(slope != 0)\n\nmap_slope <- ggplot() +\n      geom_raster(\n            data = vms_tomap,\n            aes(\n                  x = lon,\n                  y = lat,\n                  fill = log1p(slope),\n                  col = \"black\"\n            ),\n            interpolate = FALSE,\n            alpha = 0.9\n      ) +\n      scale_fill_gradient2(\n            name = \"Relative CPUE/year (slope)\",\n            high = \"firebrick\",\n            mid = \"gray90\",\n            low = \"darkblue\",\n            na.value = NA,\n            midpoint = 0,\n            guide = guide_colourbar(\n                  direction = \"horizontal\",\n                  title.position = \"top\",\n                  ticks.colour = \"black\"\n            )\n      ) +\n      geom_polygon(\n            data = map_base,\n            aes(x = lon, y = lat, group = group),\n            col = NA,\n            fill = \"grey80\"\n      ) +\n      geom_sf(\n            data = dafishr::mx_shape,\n            col = \"black\",\n            fill = \"gray99\",\n            alpha = .2\n      ) +\n      coord_sf(xlim = c(-150, -80),\n               ylim = c(-10, 32),\n               clip = \"on\") +\n      labs(x = \"\", y = \"\") +\n      theme_minimal() +\n      theme(\n            panel.background = element_rect(fill = NA, color = NA),\n            plot.background = element_rect(fill = NA, color = NA),\n            axis.text.x = element_text(angle = 90),\n            legend.position = \"bottom\",\n            legend.text = element_text(angle = 90, vjust = .5),\n            text = element_text(color = \"white\"),\n            axis.text = element_text(color = \"white\")\n      )\n\nmap_slope \n```\n\n::: {.cell-output-display}\n![Spatiotemporal variation in relative catch per unit of effort (CPUE) in the Mexican Pacific by a) Latitude, and b) longitude](index_files/figure-html/fig-spattrend-1.png){#fig-spattrend width=672}\n:::\n:::\n\n\n### Machine Learning forecast\n\n\n::: {.cell}\n\n```{.r .cell-code}\nml_output <- read_csv(\"../../data/forecast_own_model.csv\")\nml_output |> \n      ggplot(aes(x = year, y = final_yeld)) +\n      geom_point(col = \"red\") +\n      geom_smooth(method = \"lm\", col = \"red\") +\n      labs(x = \"Years\", y = \"CPUE\") +\n      theme_minimal() +\n      theme(\n            panel.background = element_rect(fill = NA, color = NA), \n            panel.grid = element_line(color = \"gray60\"), \n            plot.background = element_rect(fill = NA, color = NA),\n            axis.text.x = element_text(angle = 90),\n            legend.position = \"bottom\",\n            legend.text = element_text(angle = 90, vjust = .5),\n            text = element_text(color = \"white\"),\n            axis.text = element_text(color = \"white\")\n      )\n```\n\n::: {.cell-output-display}\n![Prediction of average CPUE due to climate change effects](index_files/figure-html/fig-MLprediction-1.png){#fig-MLprediction width=672}\n:::\n:::\n\n\nThe machine learning model uses temperature, oxygen concentration, pH, and marine primary productivity to forecast overall CPUE for the industrial fishing fleet up to 2030 (see [methods](https://cbmc-gcmp.github.io/accelerator-grant-cbmc/posts/methods/#machine-learning-model) for further details) . We found a significant decrease of CPUE (slope = -0.55, 95% CI \\[-0.72, -0.37\\], *p* \\< .001) over time @fig-MLprediction, confirming the effects of temperature variation on the potential fishing areas in the Mexican Pacific. The model therefore forecasts that by 2030 the average CPUE for the industrial vessels will be around 15 (CPUE, in tons) instead of the average of 28 of 2008-2015 period.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}