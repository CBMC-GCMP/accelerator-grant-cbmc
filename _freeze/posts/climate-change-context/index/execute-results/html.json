{
  "hash": "dc7d905b5864edcfe86dc7759d637dab",
  "result": {
    "markdown": "---\ntitle: \"Climate change context in the Mexican Pacific\"\nauthor: \"Fabio Favoretto, Eduardo León Solórzano\"\ndate: \"2022-10-15\"\ncategories: [climate-change]\nimage: \"thumbnail.png\"\ncode-fold: true\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(patchwork)\nlibrary(fst)\nlibrary(lubridate)\nlibrary(mgcv)\nlibrary(gratia)\n```\n:::\n\n\nThe Patrick McGovern foundation accelerator grant allowed us to explore the environmental data of the Mexican Pacific in an unprecedented way. Understanding the environmental changes to a greater resolution (meaning larger data, thus more computation needed) is critical to link it to other variables, from biological to anthropogenic. The ultimate goal of our project is to understand how industrial fishery is responding to environmental changes to predict future scenarios. In this section, we explore the environmental variability of the Mexican Pacific ( @fig-studyarea ), calculate its trends, and analyse the extreme events that characterized the area.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmx_eez <- dafishr::mx_eez_pacific\nmx_shape <- dafishr::mx_shape\n\nggplot() +\n      geom_sf(data = mx_eez, fill = NA, col = \"red\") +\n      geom_sf(data = mx_shape, fill = \"gray90\", col = \"black\") +\n      theme_void() +\n      theme(panel.background = element_rect(fill = NA, color = NA), \n            text = element_text(colour = \"white\"))\n```\n\n::: {.cell-output-display}\n![Map of the Mexican Pacific with the Mexican Exclusive Economic Zone in red](index_files/figure-html/fig-studyarea-1.png){#fig-studyarea width=672}\n:::\n:::\n\n\n## Sea Surface Temperature\n\nThe first key parameter to explore is Sea Surface Temperature (SST) overall trend over time. A large warming event can be seen from 2014 to 2015 ( @fig-trends ), with high average temperatures 1°C above the historical average. The temperature increase was caused by a particularly intense El Niño event which created abnormally warm waters in the Pacific. A phenomenon dubbed *\"[the blob](https://www.fisheries.noaa.gov/feature-story/new-marine-heatwave-emerges-west-coast-resembles-blob)\"* caused environmental problems all over the North American coast.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsst <- read_fst(\"../../../tropicalization_in_the_GOC/data/full_oisst_pacific_data.fst\")\n\nsst %>%\n   mutate(year = year(t)) |>\n   group_by(year) |> \n   summarise(temp = mean(temp)) |> \n   mutate(year = as.Date(paste0(year, \"-01-01\"), \"%Y-%m-%d\")) |> \n   ggplot(aes(x = year, y = temp)) +\n   geom_line(col = \"red\") +\n   geom_smooth(col = \"black\") +\n   scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\") +\n   labs(x = \"\", y = \"SST °C\") +\n   theme_minimal() +\n   theme(panel.background = element_rect(fill = NA, color = NA),\n         axis.text.x = element_text(angle = 90),\n         panel.grid.minor = element_blank(),\n         panel.grid.major.x = element_blank(),\n         text = element_text(colour = \"white\"),\n         axis.text = element_text(colour = \"white\")\n   )\n```\n\n::: {.cell-output-display}\n![Average Sea Surface Temperature (SST) trend for the Mexican Pacific. Red line represent mean variation, black line represent the smoothed trend, and the shaded areas are the 95% confidence intervals for the mean](index_files/figure-html/fig-trends-1.png){#fig-trends width=672}\n:::\n:::\n\n\nOur study area is no exception, and the large warming event continued from 2014 to 2019. A decrease in average sea surface temperature occurred only in 2021 ( @fig-trends ).\n\n### SST variation in space and time\n\nHowever, SST not only varies over time, but such variation can be of different intensities depending on the latitude. We can analyze latitude degree as a covariable along with time to understand how space influences SST variation. We can see from @fig-spacetime that SST has increased all over the latitudinal gradient, in particular, larger peaks can be seen in northern latitudes during the warming event.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_data_lat <- sst |>\n   group_by(t, lat) |>\n   summarise(Temperature = mean(temp)) |>\n   mutate(Year = year(t), nMonth = month(t)) |>\n   group_by(Year, lat) |>\n   summarise(Temperature = mean(Temperature))\n\nfullM_sst <- bam(\n   Temperature ~\n      t2(\n         Year,\n         lat,\n         bs = c(\"tp\", \"tp\"),\n         k = c(20, 20),\n         m = 2\n      ),\n   correlation = corARMA(form = ~ 1 | Year, p = 1),\n   data = mod_data_lat,\n   method = \"REML\"\n)\n\n\nnew_data <- data.frame(lat = rep(seq(from = 15, to = 31, by = 0.1), each = 41), \n                       Year = rep(seq(from = 1982, to = 2022, by = 1), 161))\n\npred_paci <- predict(fullM_sst, new_data)\n\n(\n   year_plot <- new_data |>\n      ggplot(aes(\n         x = Year,\n         y = lat,\n         z = pred_paci,\n         fill = pred_paci\n      )) +\n      geom_raster(interpolate = TRUE) +\n      geom_contour(col = \"black\") +\n      labs(fill = \"SST °C\", y = \"Latitude\") +\n      scale_x_continuous(breaks = seq(1982, 2022, by = 2)) +\n      scale_fill_distiller(\n         palette = \"RdBu\",\n         direction = -1,\n         type = \"div\"\n      ) +\n      theme_minimal() +\n      theme(\n         panel.grid = element_blank(),\n         legend.position = \"bottom\",\n         plot.title = element_text(face = \"italic\"),\n         axis.text.x = element_text(angle = 45, hjust = 1),\n         legend.title = element_text(vjust = .8),\n         text = element_text(colour = \"white\"),\n         axis.text = element_text(colour = \"white\"),\n         panel.background = element_rect(fill = NA, color = NA)\n      )\n)\n```\n\n::: {.cell-output-display}\n![Sea Surface Temperature (SST) variation over the latitudinal degree and time, better shows how temperature varied over time and space (south to north)](index_files/figure-html/fig-spacetime-1.png){#fig-spacetime width=480}\n:::\n:::\n\n\nSuch a pattern ( @fig-spacetime ) suggests that areas at higher latitudes can warm faster, and organisms that inhabit them can be relatively more threatened as they evolved in lower temperature regimes (@cheung2013; @cheung2010) .\n\nTo model how seasonality has changed, i.e. how variation in monthly temperatures occurred from 1982 to 2022 @fig-bymonths, we used generalized additive models described in the *methods* section of this site.\n\n\n::: {#fig-bymonths .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nsst_model <- sst %>%\n   mutate(Year = year(t),\n          nMonth = month(t),\n          fDegree = factor(round(lat, 0))) %>%\n   group_by(Year, nMonth) %>%\n   summarise(Temperature = mean(temp))\n\nknots <- list(nMonth = c(0.5, seq(1, 12, length = 10), 12.5))\n\nm_23 <- gamm(\n      Temperature ~ te(Year, nMonth, bs = c(\"cr\", \"cc\"), k = c(20, 12)),\n      data = sst_model,\n      method = \"REML\",\n      correlation = corARMA(form = ~ 1 | Year, p = 1),\n      knots = knots\n   )\n\npdat <- with(sst_model,\n             data.frame(\n                Year = rep(c(1982, 2022), each = 100),\n                nMonth = rep(seq(1, 12, length = 100), times = 2)\n             ))\n\npred <- predict(m_23$gam, newdata = pdat, se.fit = TRUE)\ncrit <- qt(0.975, df = df.residual(m_23$gam)) # ~95% interval critical t\npdat <- transform(\n      pdat,\n      fitted = pred$fit,\n      se = pred$se.fit,\n      fYear = as.factor(Year)\n   )\npdat <- transform(pdat,\n                  upper = fitted + (crit * se),\n                  lower = fitted - (crit * se))\n\np1 <- ggplot(pdat, aes(x = nMonth, y = fitted, group = fYear)) +\n   geom_line(aes(colour = fYear), size = 1.2) +    # predicted temperatures\n   labs(y = \"SST°C\",\n        x = \"Month\",\n        title = m_23$fDegree) +\n   scale_fill_viridis_d() +\n   scale_x_continuous(breaks = 1:12,\n                      labels = month.abb,\n                      minor_breaks = NULL) +\n   scale_y_continuous(\n      breaks = seq(15, 32, by = 4),\n      limits = c(15, 32),\n      minor_breaks = NULL\n   ) +\n   theme_minimal() +\n   theme(\n      panel.background = element_rect(fill = NA, color = NA),\n      axis.text = element_text(colour = \"white\"),\n      panel.grid = element_line(colour = \"gray50\"),      \n      legend.position = \"bottom\",\n      text = element_text(colour = \"white\"),\n      legend.margin = margin()\n   )\n\npred <- predict(m_23$gam, newdata = pdat, se.fit = TRUE)\ncrit <- qt(0.975, df = df.residual(m_23$gam)) # ~95% interval critical t\npdat <- transform(\n      pdat,\n      fitted = pred$fit,\n      se = pred$se.fit,\n      fYear = as.factor(Year)\n   )\npdat <- transform(pdat,\n                  upper = fitted + (crit * se),\n                  lower = fitted - (crit * se))\n\np2 <- pdat %>%\n   pivot_wider(nMonth, names_from = Year, values_from = fitted) %>%\n   mutate(diff = `2022` - `1982`) %>%\n   ggplot(aes(x = nMonth, y = diff)) +\n   geom_line(aes(col = \"°C Difference\"), size = 1.2) +\n   scale_color_manual(values = \"red\") +\n   scale_x_continuous(breaks = 1:12,\n                      labels = month.abb,\n                      minor_breaks = NULL) +\n   labs(\n      y = \"SST°C\",\n      x = \"Month\",\n      color = \"\",\n      title = m_23$fDegree\n   ) +\n   ylim(0, 1) +\n   theme_minimal() +\n   theme(\n      panel.background = element_rect(fill = NA, color = NA),\n      panel.grid = element_line(colour = \"gray50\"),\n      axis.text = element_text(colour = \"white\"),\n      legend.position = \"bottom\",\n      text = element_text(colour = \"white\"),\n      legend.margin = margin()\n   )\n\np1\np2 \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-bymonths-1.png){#fig-bymonths-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-bymonths-2.png){#fig-bymonths-2 width=672}\n:::\n\nChange of monthly temperatures caused by warming from 1982 to 2022. a) compares the seasonal trend of SST in 1982 and 2022; b) shows the difference between the two years, highlighting how temperatures have changed in magnitude\n:::\n\n\nOver the Mexican Pacific, summer has been 0.75 degrees Celsius higher than historical ones ( @fig-bymonths-2 ), and the increase in temperature that starts the summer season was anticipated by two weeks from mid-June to starting June. Conversely, the coming of the winter was delayed by two weeks. Overall, summer is one month longer in the Mexican Pacific than it used to be 30 years ago. As SST directly influences marine primary productivity, especially in oceanic waters, a more extended summer can mean a month less of marine productivity, translating to smaller secondary productivity (e.g., biomass) over the years.\n\n## Climate vulnerability\n\nThe best way to represent the vulnerability to climate extremes is to study extreme weather events and their frequency over time. As climate warms gradually, it is also causing an increase in frequency and magnitude of some extreme events. Recently, marine heatwaves have been defined @holbrook2020 and we know that are causing significant effects on fisheries @cheung2020 . The heatwaves analysis was calculated over each 0.1x0.1 degree pixel of the available temperature data, methods can be found **here**.\n\n\n::: {#fig-heatwaves .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nMHWs_Trend <- readRDS(file = \"../../data/MHWs_nTrend.Rds\")\n\n# The base map\nmap_base <-\n   ggplot2::fortify(maps::map(fill = TRUE, plot = FALSE)) %>%\n   dplyr::rename(lon = long)\n\nggplot() +\n   geom_rect(\n      data = MHWs_Trend,\n      size = 0.2,\n      fill = NA,\n      aes(\n         x = lon,\n         y = lat,\n         xmin = lon - 0.1,\n         xmax = lon + 0.1,\n         ymin = lat - 0.1,\n         ymax = lat + 0.1\n      )\n   ) +\n   geom_raster(\n      data = MHWs_Trend,\n      aes(x = lon, y = lat, fill = slope),\n      interpolate = FALSE,\n      alpha = 0.9\n   ) +\n   scale_fill_gradient2(\n      name = \"MHWs/year (slope)\",\n      high = \"red\",\n      mid = \"white\",\n      low = \"darkblue\",\n      midpoint = 0,\n      guide = guide_colourbar(\n         direction = \"horizontal\",\n         title.position = \"top\",\n         ticks.colour = \"black\"\n      )\n   ) +\n   geom_polygon(\n      data = map_base,\n      aes(x = lon, y = lat, group = group),\n      colour = NA,\n      fill = \"grey80\"\n   ) +\n   geom_sf(\n      data = dafishr::mx_shape,\n      colour = \"black\",\n      fill = \"gray99\",\n      alpha = .2\n   ) +\n   coord_sf(xlim = c(-130, -102),\n            ylim = c(12, 31),\n            clip = \"on\") +\n   labs(x = \"\", y = \"\") +\n   theme_minimal() +\n   theme(\n      panel.background = element_rect(fill = NA, color = NA),\n      axis.text.x = element_text(angle = 90),\n      axis.text = element_text(colour = \"white\"),\n      text = element_text(colour = \"white\"),\n      legend.position = \"bottom\",\n      legend.margin = margin(),\n      legend.text = element_text(angle = 90, vjust = .5)\n   )\n\nggplot() +\n   geom_raster(data = MHWs_Trend,\n               aes(x = lon, y = lat, fill = pval),\n               interpolate = FALSE) +\n   scale_fill_manual(\n      breaks = c(\n         \"(0,0.001]\",\n         \"(0.001,0.01]\",\n         \"(0.01,0.05]\",\n         \"(0.05,0.1]\",\n         \"(0.1,0.5]\",\n         \"(0.5,1]\"\n      ),\n      values = c(\"black\", \"grey40\", \"grey60\",\n                 \"grey80\", \"grey95\", \"white\"),\n      name = \"p-value\"\n   ) +\n   geom_polygon(\n      data = map_base,\n      aes(x = lon, y = lat, group = group),\n      colour = NA,\n      fill = \"grey80\"\n   ) +\n   geom_sf(\n      data = dafishr::mx_shape,\n      colour = \"black\",\n      fill = \"gray99\",\n      alpha = .2\n   ) +\n   coord_sf(xlim = c(-130, -102),\n            ylim = c(12, 31),\n            clip = \"on\") +\n   guides(fill = guide_legend(title.position = \"top\", title.hjust = .5)) +\n   labs(x = \"\", y = \"\") +\n   theme_minimal() +\n   theme(\n      panel.background = element_rect(fill = NA, color = NA),\n      axis.text.x = element_text(angle = 90),\n      axis.text = element_text(colour = \"white\"),\n      legend.position = \"bottom\",\n      text = element_text(colour = \"white\"),\n      legend.margin = margin(),\n      legend.title = element_text(face = \"italic\")\n   )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-heatwaves-1.png){#fig-heatwaves-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-heatwaves-2.png){#fig-heatwaves-2 width=672}\n:::\n\nMap of heatwaves frequency in the Mexican Pacific: a) represents the slope increase or decrease; a) represents the significance of the slope\n:::\n\n\nAs extreme Marine Heatwaves (MHWs) increased all over the Mexican Pacific @fig-heatwaves-1 the California Current directly influences an area that shows an inverse trend. A negative trend in MHWs suggests that this area might be critical as a refuge area and hotspot of future productivity under climate change scenarios. Identifying these regional differences underlines the importance of these smaller-scale analyses to understand the magnitude of localized climate impacts better. In the next sections, we will compare this spatio-temporal variation to fishing activity to understand its response.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}